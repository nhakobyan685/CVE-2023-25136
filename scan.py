# import paramiko
# import socket
# import colorama
# from colorama import Fore, Style

# # Initialize colorama
# colorama.init()

# ascii_text = '''

#    ██████╗ ██████╗ ███████╗███╗   ██╗███████╗███████╗██╗  ██╗     █████╗    ██╗
#   ██╔═══██╗██╔══██╗██╔════╝████╗  ██║██╔════╝██╔════╝██║  ██║    ██╔══██╗  ███║
#   ██║   ██║██████╔╝█████╗  ██╔██╗ ██║███████╗███████╗███████║    ╚██████║  ╚██║
#   ██║   ██║██╔═══╝ ██╔══╝  ██║╚██╗██║╚════██║╚════██║██╔══██║     ╚═══██║   ██║
#   ╚██████╔╝██║     ███████╗██║ ╚████║███████║███████║██║  ██║     █████╔╝██╗██║
#    ╚═════╝ ╚═╝     ╚══════╝╚═╝  ╚═══╝╚══════╝╚══════╝╚═╝  ╚═╝     ╚════╝ ╚═╝╚═╝
#              '''
# ascii_text += "\n\033[38;2;255;153;51m\033[2m CVE-2023-25136\033[0m"
# print(ascii_text)

# print ("")

# ip_file = input("Enter the list of ip addresses : ")

# client_id = "PuTTY_Release_0.64"

# def check_ssh_vulnerability(ip):
#     try:
#         client = paramiko.SSHClient()
#         client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
#         client.connect(ip, username='', password='', timeout=1)

#         print(Fore.GREEN + f"{ip}: Vulnerable" + Style.RESET_ALL)

#         client.close()

#     except (socket.error, paramiko.AuthenticationException, paramiko.SSHException):

#         print(Fore.RED + f"{ip}: Not Vulnerable" + Style.RESET_ALL)


# with open(ip_file, 'r') as f:
#     for line in f:
#         ip = line.strip()
#         check_ssh_vulnerability(ip)


try:
    import paramiko
    import socket
    import colorama
    import os
    from colorama import Fore, Style
except ImportError:
    print("pip3 install paramiko socket colorama")
    exit()

# Initialize colorama
colorama.init()

ascii_text = '''

   ██████╗ ██████╗ ███████╗███╗   ██╗███████╗███████╗██╗  ██╗     █████╗    ██╗
  ██╔═══██╗██╔══██╗██╔════╝████╗  ██║██╔════╝██╔════╝██║  ██║    ██╔══██╗  ███║
  ██║   ██║██████╔╝█████╗  ██╔██╗ ██║███████╗███████╗███████║    ╚██████║  ╚██║
  ██║   ██║██╔═══╝ ██╔══╝  ██║╚██╗██║╚════██║╚════██║██╔══██║     ╚═══██║   ██║
  ╚██████╔╝██║     ███████╗██║ ╚████║███████║███████║██║  ██║     █████╔╝██╗██║
   ╚═════╝ ╚═╝     ╚══════╝╚═╝  ╚═══╝╚══════╝╚══════╝╚═╝  ╚═╝     ╚════╝ ╚═╝╚═╝
             '''
ascii_text += "\n\033[38;2;255;153;51m\033[2m CVE-2023-25136\033[0m"
print(ascii_text)

ip_file = input("Enter the list of IP addresses: ")

try:
    with open(ip_file, 'r') as f:
        pass
except FileNotFoundError:
    print("Such a file does not exist")
    exit()

# Check if the file is empty
if os.stat(ip_file).st_size == 0:
    print("You forgot to specify the file")
    exit()


client_id = "PuTTY_Release_0.64"


def check_ssh_vulnerability(ip):
    try:
        client = paramiko.SSHClient()
        client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        client.connect(ip, username='', password='', timeout=1)

        print(Fore.GREEN + f"{ip}: Vulnerable" + Style.RESET_ALL)

        client.close()

    except (socket.error, paramiko.AuthenticationException, paramiko.SSHException):
        print(Fore.RED + f"{ip}: Not Vulnerable" + Style.RESET_ALL)


with open(ip_file, 'r') as f:
    for line in f:
        ip = line.strip()
        check_ssh_vulnerability(ip)

